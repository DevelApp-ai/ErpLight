@using ERP.SharedKernel.Contracts
@using ERP.Host.Services
@inject PluginManager PluginManager

<div class="nav-scrollable" onclick="document.querySelector('.navbar-toggler').click()">
    <nav class="flex-column">
        <!-- Core navigation items -->
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="" Match="NavLinkMatch.All">
                <span class="bi bi-house-door-fill-nav-menu" aria-hidden="true"></span> Home
            </NavLink>
        </div>

        <!-- Plugin navigation items -->
        @foreach (var plugin in PluginManager.GetPlugins<INavigationProvider>())
        {
            @foreach (var navItem in plugin.GetNavigationItems().OrderBy(x => x.Order))
            {
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="@navItem.Href">
                        @if (!string.IsNullOrEmpty(navItem.Icon))
                        {
                            <span class="@navItem.Icon" aria-hidden="true"></span>
                        }
                        @navItem.Text
                    </NavLink>
                </div>

                @if (navItem.Children.Any())
                {
                    @foreach (var childItem in navItem.Children.OrderBy(x => x.Order))
                    {
                        <div class="nav-item px-3 ms-3">
                            <NavLink class="nav-link" href="@childItem.Href">
                                @if (!string.IsNullOrEmpty(childItem.Icon))
                                {
                                    <span class="@childItem.Icon" aria-hidden="true"></span>
                                }
                                @childItem.Text
                            </NavLink>
                        </div>
                    }
                }
            }
        }

        <!-- Development navigation items (remove in production) -->
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="plugin-demo">
                <span class="bi bi-gear-fill" aria-hidden="true"></span> Plugin Demo
            </NavLink>
        </div>

        <div class="nav-item px-3">
            <NavLink class="nav-link" href="counter">
                <span class="bi bi-plus-square-fill-nav-menu" aria-hidden="true"></span> Counter
            </NavLink>
        </div>

        <div class="nav-item px-3">
            <NavLink class="nav-link" href="weather">
                <span class="bi bi-list-nested-nav-menu" aria-hidden="true"></span> Weather
            </NavLink>
        </div>
    </nav>
</div>